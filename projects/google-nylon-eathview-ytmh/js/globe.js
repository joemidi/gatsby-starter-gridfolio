"use strict";backgrounds.Globe=new Model({options:{size:80,selector:".content__location__globe"},init:function(t){this.options=t||this.options,this.data_=backgrounds.GlobeData,this.current_=[0,0],this.$pointer=document.querySelector(".content__location__globe__pointer"),this.projection_=d3.geo.orthographic().scale(this.options.size/2).translate([this.options.size/2,this.options.size/2]).clipAngle(90).rotate([-this.current_[0],-this.current_[1]]),this.path_=d3.geo.path().projection(this.projection_),this.svg_=d3.select(this.options.selector).append("svg").attr("width",this.options.size).attr("height",this.options.size),this.world_=this.svg_.append("path"),this.world_.datum(topojson.feature(this.data_,this.data_.objects.land)).attr("class","land"),this.paths_=this.svg_.selectAll("path")},toRad:function(t){return t*Math.PI/180},distance:function(t,i,s,o){var n=this.toRad(s-t),e=this.toRad(o-i),a=Math.sin(n/2)*Math.sin(n/2)+Math.cos(this.toRad(t))*Math.cos(this.toRad(s))*Math.sin(e/2)*Math.sin(e/2);return Math.atan2(Math.sqrt(a),Math.sqrt(1-a))},set:function(t){var i,s,o,n,e,a=t.lat,h=t.lng;this.$pointer.classList.add("content__location__globe__pointer--hidden"),this.old=this.current_,this.current_=[h,a],i=[this.old[0],this.old[1]],s=this.current_,(o=i[0]-s[0])>180?i[0]-=360:o<-180&&(i[0]+=360),n=this.distance(i[1],i[0],s[1],s[0]),e=Math.max(1500*n,500),d3.transition().duration(e).tween("rotation",function(){return function(t){var o=i[1],n=i[0],e=o+(s[1]-o)*t,a=n+(s[0]-n)*t;this.projection_.rotate([-a,-e]),this.paths_.attr("d",this.path_)}.bind(this)}.bind(this)).each("end",function(){this.$pointer.classList.remove("content__location__globe__pointer--hidden")}.bind(this))}});