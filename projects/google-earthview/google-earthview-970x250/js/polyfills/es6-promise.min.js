"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){function t(t){return"function"==typeof t}function e(){return function(){setTimeout(n,1)}}function n(){for(var t=0;t<g;t+=2){(0,P[t])(P[t+1]),P[t]=void 0,P[t+1]=void 0}g=0}function r(){}function o(e,n){if(n.constructor===e.constructor)!function(t,e){e._state===C?u(t,e._result):e._state===M?c(t,e._result):a(e,void 0,function(e){i(t,e)},function(e){c(t,e)})}(e,n);else{var r=function(t){try{return t.then}catch(t){return O.error=t,O}}(n);r===O?c(e,O.error):void 0===r?u(e,n):t(r)?function(t,e,n){w(function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,function(n){r||(r=!0,e!==n?i(t,n):u(t,n))},function(e){r||(r=!0,c(t,e))},t._label);!r&&o&&(r=!0,c(t,o))},t)}(e,n,r):u(e,n)}}function i(t,e){t===e?c(t,new TypeError("You cannot resolve a promise with itself")):!function(t){return"function"==typeof t||"object"===(void 0===t?"undefined":_typeof(t))&&null!==t}(e)?u(t,e):o(t,e)}function s(t){t._onerror&&t._onerror(t._result),f(t)}function u(t,e){t._state===x&&(t._result=e,t._state=C,0!==t._subscribers.length&&w(f,t))}function c(t,e){t._state===x&&(t._state=M,t._result=e,w(s,t))}function a(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+C]=n,o[i+M]=r,0===i&&t._state&&w(f,t)}function f(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?h(n,r,o,i):o(i);t._subscribers.length=0}}function l(){this.error=null}function h(e,n,r,o){var s,a,f,l,h=t(r);if(h){if((s=function(t,e){try{return t(e)}catch(t){return Y.error=t,Y}}(r,o))===Y?(l=!0,a=s.error,s=null):f=!0,n===s)return void c(n,new TypeError("A promises callback cannot return that same promise."))}else s=o,f=!0;n._state!==x||(h&&f?i(n,s):l?c(n,a):e===C?u(n,s):e===M&&c(n,s))}function p(t,e){this._instanceConstructor=t,this.promise=new t(r),this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?u(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&u(this.promise,this._result))):c(this.promise,this._validationError())}function _(e){this._id=D++,this._state=void 0,this._result=void 0,this._subscribers=[],r!==e&&(t(e)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof _||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(t,e){try{e(function(e){i(t,e)},function(e){c(t,e)})}catch(e){c(t,e)}}(this,e))}var d,y,v,m,b=d=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},g=0,w=function(t,e){P[g]=t,P[g+1]=e,2===(g+=2)&&(v?v(n):m())},A="undefined"!=typeof window?window:void 0,S=A||{},E=S.MutationObserver||S.WebKitMutationObserver,j="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),T="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,P=new Array(1e3);m=j?function(){process.nextTick(n)}:E?function(){var t=0,e=new E(n),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}():T?function(){var t=new MessageChannel;return t.port1.onmessage=n,function(){t.port2.postMessage(0)}}():void 0===A&&"function"==typeof require?function(){try{var t=require("vertx");return y=t.runOnLoop||t.runOnContext,function(){y(n)}}catch(t){return e()}}():e();var x=void 0,C=1,M=2,O=new l,Y=new l;p.prototype._validateInput=function(t){return b(t)},p.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},p.prototype._init=function(){this._result=new Array(this.length)};var k=p;p.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,r=0;e._state===x&&r<t;r++)this._eachEntry(n[r],r)},p.prototype._eachEntry=function(t,e){var n=this._instanceConstructor;!function(t){return"object"===(void 0===t?"undefined":_typeof(t))&&null!==t}(t)?(this._remaining--,this._result[e]=t):t.constructor===n&&t._state!==x?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(n.resolve(t),e)},p.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===x&&(this._remaining--,t===M?c(r,n):this._result[e]=n),0===this._remaining&&u(r,this._result)},p.prototype._willSettleAt=function(t,e){var n=this;a(t,void 0,function(t){n._settledAt(C,e,t)},function(t){n._settledAt(M,e,t)})};var q=function(t){function e(t){i(o,t)}function n(t){c(o,t)}var o=new this(r);if(!b(t))return c(o,new TypeError("You must pass an array to race.")),o;for(var s=t.length,u=0;o._state===x&&u<s;u++)a(this.resolve(t[u]),void 0,e,n);return o},F=function(t){if(t&&"object"===(void 0===t?"undefined":_typeof(t))&&t.constructor===this)return t;var e=new this(r);return i(e,t),e},I=function(t){var e=new this(r);return c(e,t),e},D=0,K=_;_.all=function(t){return new k(this,t).promise},_.race=q,_.resolve=F,_.reject=I,_._setScheduler=function(t){v=t},_._setAsap=function(t){w=t},_._asap=w,_.prototype={constructor:_,then:function(t,e){var n=this._state;if(n===C&&!t||n===M&&!e)return this;var o=new this.constructor(r),i=this._result;if(n){var s=arguments[n-1];w(function(){h(n,o,s,i)})}else a(this,o,t,e);return o},catch:function(t){return this.then(null,t)}};var L=function(){var t;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;e&&"[object Promise]"===Object.prototype.toString.call(e.resolve())&&!e.cast||(t.Promise=K)},N={Promise:K,polyfill:L};"function"==typeof define&&define.amd?define(function(){return N}):"undefined"!=typeof module&&module.exports?module.exports=N:void 0!==this&&(this.ES6Promise=N),L()}).call(void 0);